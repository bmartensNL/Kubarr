name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  backend-tests:
    uses: ./.github/workflows/backend-tests.yml

  frontend-check:
    uses: ./.github/workflows/frontend-check.yml

  build-images:
    uses: ./.github/workflows/build-images.yml
    with:
      image-tag: ci-${{ github.sha }}

  e2e-tests:
    needs: build-images
    uses: ./.github/workflows/e2e-tests.yml
    with:
      image-tag: ci-${{ github.sha }}
